test -s /Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/bin/controller-gen && /Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/bin/controller-gen --version | grep -q v0.11.1 || \
	GOBIN=/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/bin go install sigs.k8s.io/controller-tools/cmd/controller-gen@v0.11.1
/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/bin/controller-gen rbac:roleName=mpas-product-controller-role crd webhook paths="./..." output:crd:artifacts:config=config/crd/bases
/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/bin/controller-gen object:headerFile="hack/boilerplate.go.txt" paths="./..."
go fmt ./...
go vet ./...
KUBEBUILDER_ASSETS="/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/bin/k8s/1.26.0-darwin-amd64" go test ./... -v -run TestTargetReconciler -coverprofile cover.out
?   	github.com/open-component-model/mpas-product-controller	[no test files]
?   	github.com/open-component-model/mpas-product-controller/api/v1alpha1	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/deployers	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/ocm/fakes	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/validators	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/validators/gitea	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/validators/github	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/version	[no test files]
?   	github.com/open-component-model/mpas-product-controller/pkg/version/generate	[no test files]
=== RUN   TestTargetReconciler_Reconcile
=== RUN   TestTargetReconciler_Reconcile/Target_Ready_with_no_secret
    target_controller_test.go:128: 
        	Error Trace:	/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:128
        	            				/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:101
        	Error:      	Condition never satisfied
        	Test:       	TestTargetReconciler_Reconcile/Target_Ready_with_no_secret
    target_controller_test.go:128: 
        	Error Trace:	/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:128
        	            				/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:117
        	Error:      	Condition never satisfied
        	Test:       	TestTargetReconciler_Reconcile/Target_Ready_with_no_secret
[{Ready True 0 2023-10-09 11:51:29 +0200 CEST Succeeded Target is ready}] [{Ready True 0 0001-01-01 00:00:00 +0000 UTC Succeeded Target is ready}]
=== RUN   TestTargetReconciler_Reconcile/Target_Ready_with_a_secret
[controller-runtime] log.SetLogger(...) was never called, logs will not be displayed:
goroutine 225 [running]:
runtime/debug.Stack()
	/usr/local/opt/go/libexec/src/runtime/debug/stack.go:24 +0x5e
sigs.k8s.io/controller-runtime/pkg/log.eventuallyFulfillRoot()
	/Users/souleb/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.1/pkg/log/log.go:59 +0xcd
sigs.k8s.io/controller-runtime/pkg/log.(*delegatingLogSink).WithValues(0xc000687600, {0x0, 0x0, 0x0})
	/Users/souleb/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.1/pkg/log/deleg.go:168 +0x49
github.com/go-logr/logr.Logger.WithValues(...)
	/Users/souleb/go/pkg/mod/github.com/go-logr/logr@v1.2.4/logr.go:323
sigs.k8s.io/controller-runtime/pkg/log.FromContext({0x103631908?, 0x1054ab860?}, {0x0?, 0x0?, 0x0?})
	/Users/souleb/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.15.1/pkg/log/log.go:89 +0xf7
github.com/open-component-model/mpas-product-controller/controllers.(*TargetReconciler).Reconcile(0xc000d3bf10, {0x103631908, 0x1054ab860}, {{{0xc000d0d370, 0xb}, {0xc000d0d360, 0xb}}})
	/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller.go:78 +0xba
github.com/open-component-model/mpas-product-controller/controllers.TestTargetReconciler_Reconcile.func3(0x8c?)
	/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:99 +0x285
testing.tRunner(0xc000da2340, 0xc00035a9c0)
	/usr/local/opt/go/libexec/src/testing/testing.go:1595 +0xff
created by testing.(*T).Run in goroutine 31
	/usr/local/opt/go/libexec/src/testing/testing.go:1648 +0x3ad
    target_controller_test.go:128: 
        	Error Trace:	/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:128
        	            				/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:101
        	Error:      	Condition never satisfied
        	Test:       	TestTargetReconciler_Reconcile/Target_Ready_with_a_secret
    target_controller_test.go:128: 
        	Error Trace:	/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:128
        	            				/Users/souleb/go/src/github.com/open-component-model/mpas-product-controller/controllers/target_controller_test.go:117
        	Error:      	Condition never satisfied
        	Test:       	TestTargetReconciler_Reconcile/Target_Ready_with_a_secret
[{Ready True 0 2023-10-09 11:51:29 +0200 CEST Succeeded Target is ready}] [{Ready True 0 0001-01-01 00:00:00 +0000 UTC Succeeded Target is ready}]
--- FAIL: TestTargetReconciler_Reconcile (80.02s)
    --- FAIL: TestTargetReconciler_Reconcile/Target_Ready_with_no_secret (40.01s)
    --- FAIL: TestTargetReconciler_Reconcile/Target_Ready_with_a_secret (40.00s)
FAIL
coverage: 7.3% of statements
FAIL	github.com/open-component-model/mpas-product-controller/controllers	81.816s
testing: warning: no tests to run
PASS
coverage: 0.0% of statements
ok  	github.com/open-component-model/mpas-product-controller/pkg/deployers/kubernetes	0.674s	coverage: 0.0% of statements [no tests to run]
time="2023-10-09T11:51:30+02:00" level=warning msg="No HTTP secret provided - generated random secret. This may cause problems with uploads if multiple registries are behind a load-balancer. To provide a shared secret, fill in http.secret in the configuration file or set the REGISTRY_HTTP_SECRET environment variable." go.version=go1.21.1
time="2023-10-09T11:51:30+02:00" level=info msg="redis not configured" go.version=go1.21.1
time="2023-10-09T11:51:30+02:00" level=info msg="Starting upload purge in 21m0s" go.version=go1.21.1
testing: warning: no tests to run
PASS
coverage: 0.0% of statements
ok  	github.com/open-component-model/mpas-product-controller/pkg/ocm	2.734s	coverage: 0.0% of statements [no tests to run]
testing: warning: no tests to run
PASS
coverage: 0.0% of statements
ok  	github.com/open-component-model/mpas-product-controller/pkg/validators/rego	0.725s	coverage: 0.0% of statements [no tests to run]
FAIL
